"use strict";ve.ui.CodeMirrorTool=function(){ve.ui.CodeMirrorTool.super.apply(this,arguments),this.extCodeMirror=this.toolbar.surface.mirror,this.toolbar.connect(this,{surfaceChange:"onSurfaceChange"})},OO.inheritClass(ve.ui.CodeMirrorTool,ve.ui.Tool),ve.ui.CodeMirrorTool.static.name="codeMirror",ve.ui.CodeMirrorTool.static.autoAddToCatchall=!1,ve.ui.CodeMirrorTool.static.title=OO.ui.deferMsg("codemirror-toggle-label"),ve.ui.CodeMirrorTool.static.icon="highlight",ve.ui.CodeMirrorTool.static.group="utility",ve.ui.CodeMirrorTool.static.commandName="codeMirror",ve.ui.CodeMirrorTool.static.deactivateOnSelect=!1,ve.ui.CodeMirrorTool.prototype.onSelect=function(){ve.ui.CodeMirrorTool.super.prototype.onSelect.apply(this,arguments),console.log("where"),this.extCodeMirror||(this.extCodeMirror=this.toolbar.surface.mirror);var o=!(!this.extCodeMirror||!this.extCodeMirror.view);this.setActive(o),this.extCodeMirror.setCodeMirrorPreference(o),this.extCodeMirror.logUsage({editor:"wikitext-2017",enabled:o,toggled:!0,edit_start_ts_ms:1e3*this.toolbar.target.startTimeStamp||0})},ve.ui.CodeMirrorTool.prototype.onSurfaceChange=function(o,e){console.log("haha");var r="source"!==e.getMode();if(this.setDisabled(r),!r){var t=this.getCommand(),i=this.toolbar.getSurface(),s=mw.user.options.get("usecodemirror")>0;t.execute(i,[s]),this.setActive(s),this.toolbar.target.startTimeStamp&&this.extCodeMirror.logUsage({editor:"wikitext-2017",enabled:s,toggled:!1,edit_start_ts_ms:1e3*this.toolbar.target.startTimeStamp||0})}},ve.ui.CodeMirrorTool.prototype.onUpdateState=function(){},ve.ui.toolFactory.register(ve.ui.CodeMirrorTool),ve.ui.commandRegistry.register(new ve.ui.Command("codeMirror","codeMirror","toggle"));
